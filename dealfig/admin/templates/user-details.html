{% import 'modals.html' as modals %}

<div style="font-weight: bold;">Name
    <button type="button" class="btn btn-info btn-xs" data-toggle="modal" data-target="#{{ modals.modal_id('name') }}">
        <span class="glyphicon glyphicon-pencil"></span> Edit 
    </button>
</div>
<div id="name-display" style="margin-left:25px; min-height:1em;">
    <span id="first_name_display">{{ user.first_name }}</span> <span id="last_name_display">{{ user.last_name }}</span>
</div>

<div style="height: 10px;"></div>

<div style="font-weight: bold;">Role</div>
<button type="button" class="btn btn-default" data-toggle="modal" data-target="#{{ modals.modal_id('role') }}" id="role-display" style="min-width:100px; min-height: 30px;">
    {{ user.role_name }}
</button>

<div style="height: 10px;"></div>

<div style="font-weight: bold;">Email
    <button type="button" class="btn btn-info btn-xs" data-toggle="modal" data-target="#{{ modals.modal_id('email') }}">
        <span class="glyphicon glyphicon-pencil"></span> Edit 
    </button>
</div>
<div style="margin-left:25px; min-height:1em;">
    {% if user.emails %}
    <a id="email-display" href="{{ user.emails[0] }}" target="_blank">{{ user.emails[0] }}</a>
    {% else %}
    <a id="email-display" href="" target="_blank"></a>
    {% endif %}
</div>

<!-- Input modals -->
<!-- Name modal -->
{% with %}
{% set form_modal_body %}
<label for="first_name_input">First Name</label>
<input type="text" class="form-control" id="first_name_input" placeholder="First Name" value="{{ user.first_name }}" />
<label for="last_name_input">Last Name</label>
<input type="text" class="form-control" id="last_name_input" placeholder="Last Name" value="{{ user.last_name }}" />
{% endset %}
{{ modals.form_modal(modals.modal_id("name"), "Name", form_modal_body) }}
{% endwith %}
<!-- User Role modal -->
{{ modals.list_modal(modals.modal_id('role'), "Role", user_roles) }}
<!-- Email modal -->
{{ modals.textbox_modal(modals.modal_id('email'), "Email", user.emails[0], "email") }}

<script>
// Modal JavaScript
{% with input_map = {"first_name": {"input": "#first_name_input", "display": "#first_name_display"}, "last_name": {"input": "#last_name_input", "display": "#last_name_display"}} %}
{{ modals.form_modal_js(modals.modal_id("name"), url_for('admin.update_user_name', username=user.username), input_map)|safe }}
{% endwith %}

{{ modals.list_modal_js(modals.modal_id('role'), url_for('admin.update_user_role', username=user.username), "role-display")|safe }}
{{ modals.textbox_modal_js(modals.modal_id('email'), url_for('admin.update_user_email', username=user.username), "email-display")|safe }}
</script>